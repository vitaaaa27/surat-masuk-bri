<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistem Register Surat Masuk - BRI KCP Jelutung</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-blue-100 min-h-screen">
    <!-- Header -->
    <header class="bg-blue-600 text-white shadow-lg">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <div class="bg-white px-3 py-1 rounded">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/2/2e/BRI_2020.svg" alt="BRI Logo" class="h-12">
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold">Sistem Register Surat Masuk</h1>
                        <p class="text-blue-100 text-sm">BRI Kantor Cabang Pembantu Jelutung</p>
                    </div>
                </div>
                <div class="flex items-center space-x-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <span class="text-sm" id="currentDate"></span>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-6 py-8">
        <!-- Dashboard Cards -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
            <div class="bg-white rounded-lg shadow-md p-6 border-l-4 border-blue-500">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-gray-500 text-sm">Total Surat Masuk</p>
                        <p class="text-3xl font-bold text-gray-800 mt-1" id="totalSurat">0</p>
                    </div>
                    <svg class="w-12 h-12 text-blue-500 opacity-80" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                    </svg>
                </div>
            </div>
            
            <div class="bg-white rounded-lg shadow-md p-6 border-l-4 border-green-500">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-gray-500 text-sm">Bulan Ini</p>
                        <p class="text-3xl font-bold text-gray-800 mt-1" id="bulanIni">0</p>
                    </div>
                    <svg class="w-12 h-12 text-green-500 opacity-80" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                    </svg>
                </div>
            </div>
            
            <div class="bg-white rounded-lg shadow-md p-6 border-l-4 border-yellow-500">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-gray-500 text-sm">Menunggu Tindak Lanjut</p>
                        <p class="text-3xl font-bold text-gray-800 mt-1">8</p>
                    </div>
                    <svg class="w-12 h-12 text-yellow-500 opacity-80" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                    </svg>
                </div>
            </div>
            
            <div class="bg-white rounded-lg shadow-md p-6 border-l-4 border-purple-500">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-gray-500 text-sm">Selesai Ditindaklanjuti</p>
                        <p class="text-3xl font-bold text-gray-800 mt-1">15</p>
                    </div>
                    <svg class="w-12 h-12 text-purple-500 opacity-80" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                    </svg>
                </div>
            </div>
        </div>

        <!-- Search and Add Section -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-8">
            <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
                <div class="relative flex-1">
                    <svg class="absolute left-3 top-3 w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                    </svg>
                    <input
                        type="text"
                        id="searchInput"
                        placeholder="Cari berdasarkan nomor surat, pengirim, atau maksud surat..."
                        class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                        onkeyup="searchTable()"
                    />
                </div>
                <a href="tambah-surat.html" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg flex items-center justify-center space-x-2 transition duration-200 shadow-md">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                    </svg>
                    <span class="font-semibold">Tambah Surat Masuk</span>
                </a>
            </div>
        </div>

        <!-- Table Section -->
        <div class="bg-white rounded-lg shadow-md overflow-hidden">
            <div class="overflow-x-auto">
                <table class="w-full" id="suratTable">
                    <thead class="bg-blue-600 text-white">
                        <tr>
                            <th class="px-4 py-3 text-left text-sm font-semibold">Nomor</th>
                            <th class="px-4 py-3 text-left text-sm font-semibold">Bandel</th>
                            <th class="px-4 py-3 text-left text-sm font-semibold">Diterima Tanggal</th>
                            <th class="px-4 py-3 text-left text-sm font-semibold">Dikirim</th>
                            <th class="px-4 py-3 text-left text-sm font-semibold">Si Pengirim</th>
                            <th class="px-4 py-3 text-left text-sm font-semibold">Nomor Surat Pengirim</th>
                            <th class="px-4 py-3 text-left text-sm font-semibold">Tanggal Surat Pengirim</th>
                            <th class="px-4 py-3 text-left text-sm font-semibold">Ditujukan Kepada</th>
                            <th class="px-4 py-3 text-left text-sm font-semibold">Maksud Surat</th>
                            <th class="px-4 py-3 text-left text-sm font-semibold">Jawaban Dari Agenda No</th>
                            <th class="px-4 py-3 text-left text-sm font-semibold">Jawaban Dengan Agenda No</th>
                            <th class="px-4 py-3 text-left text-sm font-semibold">Catatan Lebih Lanjut</th>
                            <th class="px-4 py-3 text-left text-sm font-semibold">Dokumen</th>
                            <th class="px-4 py-3 text-left text-sm font-semibold">Aksi</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody" class="divide-y divide-gray-200">
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Pagination -->
        <div class="mt-6 flex items-center justify-between bg-white rounded-lg shadow-md px-6 py-4">
            <p class="text-sm text-gray-600" id="paginationInfo">Menampilkan data</p>
            <div class="flex space-x-2">
                <button class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 text-sm">Previous</button>
                <button class="px-4 py-2 bg-blue-600 text-white rounded-lg text-sm">1</button>
                <button class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 text-sm">2</button>
                <button class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 text-sm">Next</button>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-blue-600 text-white mt-12 py-6">
        <div class="container mx-auto px-6 text-center">
            <p class="text-sm">Â© 2024 Bank Rakyat Indonesia - KCP Jelutung. Sistem Register Surat Masuk.</p>
        </div>
    </footer>

    <script>
        let dataSurat = [];

        // Load data saat halaman dibuka
        window.onload = function() {
            loadData();
            updateDate();
            renderTable();
            updateStats();
        };

        // Tampilkan tanggal
        function updateDate() {
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const today = new Date().toLocaleDateString('id-ID', options);
            document.getElementById('currentDate').textContent = today;
        }

        // Load data dari localStorage
        function loadData() {
            const saved = localStorage.getItem('dataSuratMasuk');
            if (saved) {
                dataSurat = JSON.parse(saved);
            }
        }

        // Update statistik
        function updateStats() {
            document.getElementById('totalSurat').textContent = dataSurat.length;
            
            const thisMonth = new Date().getMonth();
            const thisYear = new Date().getFullYear();
            const bulanIniCount = dataSurat.filter(s => {
                const date = new Date(s.diterimaTgl);
                return date.getMonth() === thisMonth && date.getFullYear() === thisYear;
            }).length;
            document.getElementById('bulanIni').textContent = bulanIniCount;
        }

        // Render tabel
        function renderTable() {
            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = '';

            if (dataSurat.length === 0) {
                tbody.innerHTML = '<tr><td colspan="14" class="text-center py-8 text-gray-500">Belum ada data surat masuk. Klik "Tambah Surat Masuk" untuk mulai menginput data.</td></tr>';
                return;
            }

            dataSurat.forEach((surat, index) => {
                const row = tbody.insertRow();
                row.className = 'hover:bg-blue-50 transition duration-150';
                
                const dokumen = surat.dokumen ? 
                    `<button onclick="lihatDokumen(${index})" class="text-blue-600 hover:text-blue-800 flex items-center justify-center mx-auto">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                        </svg>
                    </button>` : '<span class="text-gray-400">-</span>';

                row.innerHTML = `
                    <td class="px-4 py-3 text-sm font-medium text-blue-600">${surat.nomor}</td>
                    <td class="px-4 py-3 text-sm"><span class="bg-blue-100 text-blue-800 px-2 py-1 rounded font-semibold">${surat.bandel}</span></td>
                    <td class="px-4 py-3 text-sm">${formatDate(surat.diterimaTgl)}</td>
                    <td class="px-4 py-3 text-sm">${surat.dikirim}</td>
                    <td class="px-4 py-3 text-sm">${surat.siPengirim}</td>
                    <td class="px-4 py-3 text-sm">${surat.nomorSuratPengirim || '-'}</td>
                    <td class="px-4 py-3 text-sm">${surat.tanggalSuratPengirim ? formatDate(surat.tanggalSuratPengirim) : '-'}</td>
                    <td class="px-4 py-3 text-sm">${surat.ditujukanKepada}</td>
                    <td class="px-4 py-3 text-sm max-w-xs">${surat.maksudSurat}</td>
                    <td class="px-4 py-3 text-sm text-center">${surat.jawabanDari || '-'}</td>
                    <td class="px-4 py-3 text-sm text-center">${surat.jawabanDengan || '-'}</td>
                    <td class="px-4 py-3 text-sm">${surat.catatan || '-'}</td>
                    <td class="px-4 py-3 text-sm text-center">${dokumen}</td>
                    <td class="px-4 py-3 text-sm">
                        <button onclick="hapusSurat(${index})" class="text-red-600 hover:text-red-800">Hapus</button>
                    </td>
                `;
            });

            document.getElementById('paginationInfo').textContent = `Menampilkan ${dataSurat.length} data`;
        }

        // Format tanggal
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('id-ID');
        }

        // Fungsi pencarian
        function searchTable() {
            const input = document.getElementById('searchInput').value.toUpperCase();
            const tbody = document.getElementById('tableBody');
            const rows = tbody.getElementsByTagName('tr');

            for (let i = 0; i < rows.length; i++) {
                let found = false;
                const cells = rows[i].getElementsByTagName('td');
                
                for (let j = 0; j < cells.length; j++) {
                    const txtValue = cells[j].textContent || cells[j].innerText;
                    if (txtValue.toUpperCase().indexOf(input) > -1) {
                        found = true;
                        break;
                    }
                }
                
                rows[i].style.display = found ? '' : 'none';
            }
        }

        // Lihat dokumen
        function lihatDokumen(index) {
            const surat = dataSurat[index];
            const newWindow = window.open('', '_blank');
            newWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Dokumen - ${surat.nomor}</title>
                    <style>
                        body { margin: 0; padding: 20px; background: #f0f0f0; text-align: center; font-family: Arial; }
                        img { max-width: 100%; height: auto; box-shadow: 0 4px 6px rgba(0,0,0,0.1); border-radius: 8px; }
                        h2 { color: #1e40af; }
                        .info { background: white; padding: 15px; border-radius: 8px; margin: 20px auto; max-width: 600px; }
                    </style>
                </head>
                <body>
                    <h2>ðŸ“„ Dokumen Surat</h2>
                    <div class="info">
                        <p><strong>Nomor:</strong> ${surat.nomor}</p>
                        <p><strong>Pengirim:</strong> ${surat.siPengirim}</p>
                        <p><strong>Tanggal Diterima:</strong> ${formatDate(surat.diterimaTgl)}</p>
                    </div>
                    <img src="${surat.dokumen}" alt="Dokumen">
                </body>
                </html>
            `);
        }

        // Hapus surat
        function hapusSurat(index) {
            const surat = dataSurat[index];
            if (confirm('Apakah Anda yakin ingin menghapus surat nomor ' + surat.nomor + '?')) {
                dataSurat.splice(index, 1);
                localStorage.setItem('dataSuratMasuk', JSON.stringify(dataSurat));
                renderTable();
                updateStats();
                alert('âœ… Surat berhasil dihapus!');
            }
        }
    </script>
</body>
</html>
